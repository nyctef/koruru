<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Soundboard (audiosurf clone) (temporary name): src/modes/cMonoMode.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.5 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="classes.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<h1>src/modes/cMonoMode.cpp</h1><a href="cMonoMode_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#include "<a class="code" href="cMonoMode_8h.html">cMonoMode.h</a>"</span>
<a name="l00002"></a>00002 
<a name="l00003"></a><a class="code" href="classcMonoMode.html#c48dd81210aca70340fa43fd7709dff6">00003</a> <a class="code" href="classcMonoMode.html#c48dd81210aca70340fa43fd7709dff6">cMonoMode::cMonoMode</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* name) : <a class="code" href="classcPlayMode.html">cPlayMode</a>(name) {
<a name="l00004"></a>00004 }
<a name="l00005"></a>00005 
<a name="l00006"></a><a class="code" href="classcMonoMode.html#73dd0a97dc0776c2ff3ec532cb0fed11">00006</a> <a class="code" href="classcMonoMode.html#73dd0a97dc0776c2ff3ec532cb0fed11">cMonoMode::~cMonoMode</a>() {
<a name="l00007"></a>00007 }
<a name="l00008"></a>00008 
<a name="l00009"></a><a class="code" href="classcMonoMode.html#1ac9feba1166226ff8fe0f8d0d379c2f">00009</a> <span class="keywordtype">int</span> <a class="code" href="classcMonoMode.html#1ac9feba1166226ff8fe0f8d0d379c2f">cMonoMode::init</a> () {
<a name="l00010"></a>00010         <a class="code" href="includes_8cpp.html#ff964b67fcabe155d88dff5b06278f69" title="Set common GL variables to predetermined sets of values.">InitMode</a>(<a class="code" href="includes_8h.html#9a3de7c5e89b21dec1c78d77c43d8fe9">RESET_MODE</a> | <a class="code" href="includes_8h.html#0e6eed752f69ec92baec7d38a6ff3f04">GAME_MODE</a>);
<a name="l00011"></a>00011         <a class="code" href="main_8cpp.html#e3496037f16ba1b4bde4864dc219e026">score</a> = 0;
<a name="l00012"></a>00012         <a class="code" href="main_8cpp.html#7f7e4724cf57d59513b39c5ecc81adc8">speed</a> = 2*<a class="code" href="main_8cpp.html#1dcc4c751312e83f33e6be560fe1c15d">bpm</a>/60;
<a name="l00013"></a>00013         <span class="keywordflow">if</span> (<a class="code" href="classcPlayMode.html#0f3eefd8ebff420fe1f1dd5f75c70688">createpickup_thread</a> == NULL) <a class="code" href="classcPlayMode.html#0f3eefd8ebff420fe1f1dd5f75c70688">createpickup_thread</a> = SDL_CreateThread(<a class="code" href="cPlayMode_8cpp.html#3d00ff2c7c81826b98c3c861c1a9d416">generate_pickups_thread</a>, (<span class="keywordtype">void</span>*)<span class="keyword">this</span>);
<a name="l00014"></a>00014         <span class="keywordflow">return</span> 0;
<a name="l00015"></a>00015 }
<a name="l00016"></a>00016 
<a name="l00017"></a><a class="code" href="classcMonoMode.html#8cd8b269ab4e025fb299a69c4f171f9b">00017</a> <span class="keywordtype">void</span> <a class="code" href="classcMonoMode.html#8cd8b269ab4e025fb299a69c4f171f9b">cMonoMode::drawship</a>() {
<a name="l00018"></a>00018         glTranslatef( (-0.5+<a class="code" href="classcPlayMode.html#476358dd379019dcfbe68cbd3581da9b">ship</a>.<a class="code" href="classcShip.html#508f13231ac102dce4369c2540d40ae2">xpos</a>)*<a class="code" href="cMonoMode_8h.html#e0b368bc8ac06e6fe182f066b277ad78">MONO_TRACK_WIDTH</a>, 0, 0);
<a name="l00019"></a>00019         <a class="code" href="classcPlayMode.html#476358dd379019dcfbe68cbd3581da9b">ship</a>.<a class="code" href="classcShip.html#d8a161c66b9a857e1f2bf3bfab1d0b40">draw</a>();
<a name="l00020"></a>00020 }
<a name="l00021"></a>00021 
<a name="l00022"></a><a class="code" href="classcMonoMode.html#706925afeb2d554aa800510b84bb0af4">00022</a> <span class="keywordtype">void</span> <a class="code" href="classcMonoMode.html#706925afeb2d554aa800510b84bb0af4">cMonoMode::drawtrack</a>() {
<a name="l00023"></a>00023         glPushMatrix();
<a name="l00024"></a>00024                 <span class="comment">//glColor3fv(color[BLUE][0]);</span>
<a name="l00025"></a>00025                 
<a name="l00026"></a>00026                 <span class="comment">// give the illusion of a continually-moving track</span>
<a name="l00027"></a>00027                 <a class="code" href="classcPlayMode.html#10bf623113220fed3280c2c119116531">trackdisp</a> += 0.06*<a class="code" href="main_8cpp.html#bb10fb021d3c0bdc4647fdbec83be1cc">dtime</a>*<a class="code" href="main_8cpp.html#7f7e4724cf57d59513b39c5ecc81adc8">speed</a>;
<a name="l00028"></a>00028                 <span class="keywordflow">if</span> (<a class="code" href="classcPlayMode.html#10bf623113220fed3280c2c119116531">trackdisp</a> &gt; 18) <a class="code" href="classcPlayMode.html#10bf623113220fed3280c2c119116531">trackdisp</a> -= 18;
<a name="l00029"></a>00029                 glTranslatef(0, 0, 20+<a class="code" href="classcPlayMode.html#10bf623113220fed3280c2c119116531">trackdisp</a>);
<a name="l00030"></a>00030                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;100; i++) {
<a name="l00031"></a>00031                         <a class="code" href="main_8cpp.html#ae56bde25963ab1b5b2ed66cd90e69d3">track</a>-&gt;<a class="code" href="classc3DSModel.html#f75412da827e3e8bd005d0a363aa57c2">Draw</a>();
<a name="l00032"></a>00032                         glTranslatef(0, 0, -18);
<a name="l00033"></a>00033                 }
<a name="l00034"></a>00034         glPopMatrix();
<a name="l00035"></a>00035         
<a name="l00036"></a>00036         <a class="code" href="classcMonoMode.html#f8b14aa69621178a50395c26ff897f93">changemonocolour</a>();
<a name="l00037"></a>00037 }
<a name="l00038"></a>00038 
<a name="l00039"></a><a class="code" href="classcMonoMode.html#f7e7084c8a80667f9b1b266ef284c10c">00039</a> <span class="keywordtype">void</span> <a class="code" href="classcMonoMode.html#f7e7084c8a80667f9b1b266ef284c10c">cMonoMode::CreatePickups</a>() {
<a name="l00040"></a>00040         Uint32 <a class="code" href="classcPlayMode.html#5cc183c54a1035c87f5a2cdd02b08ece">newobjecttimer</a> = SDL_GetTicks();
<a name="l00041"></a>00041         <span class="keywordtype">int</span> <a class="code" href="classcPlayMode.html#2fd1772ddc1b0c497e42e211fc062ed1">pickupcount</a> = 0;
<a name="l00042"></a>00042         <span class="keywordflow">while</span> (1) {
<a name="l00043"></a>00043                 <span class="keywordflow">if</span> (<a class="code" href="classcPlayMode.html#de014c8a7beb686a36ea11ae5be57116">quit_createpickup_thread</a>) <span class="keywordflow">break</span>;
<a name="l00044"></a>00044                 
<a name="l00045"></a>00045                 <span class="keywordflow">if</span> (SDL_GetTicks() - newobjecttimer &gt;= 250/<a class="code" href="main_8cpp.html#7f7e4724cf57d59513b39c5ecc81adc8">speed</a>) {
<a name="l00046"></a>00046                         <span class="keywordflow">if</span> (pickupcount == 0) {
<a name="l00047"></a>00047                                 <span class="keywordflow">if</span> (<a class="code" href="includes_8cpp.html#5d595d84d8fbac52afb180d70fd06223">GenerateRandomNumber</a>(1, 3) == 1) { 
<a name="l00048"></a>00048                                         <a class="code" href="classcPlayMode.html#508e0cbf73c071e90cfcfe84d7b111ca" title="The current pickup (lane) position.">currentposition</a> = <a class="code" href="includes_8cpp.html#5d595d84d8fbac52afb180d70fd06223">GenerateRandomNumber</a>(0,2);
<a name="l00049"></a>00049                                         <a class="code" href="classcPlayMode.html#cb3bf89d91bdc776c9afd47d2d97646b" title="The current pickup colour.">currentcolour</a> = <a class="code" href="includes_8cpp.html#5d595d84d8fbac52afb180d70fd06223">GenerateRandomNumber</a>(1,2);
<a name="l00050"></a>00050                                                 <a class="code" href="classcPlayMode.html#cb3bf89d91bdc776c9afd47d2d97646b" title="The current pickup colour.">currentcolour</a> = (<a class="code" href="classcPlayMode.html#cb3bf89d91bdc776c9afd47d2d97646b" title="The current pickup colour.">currentcolour</a> == 1) ? <a class="code" href="includes_8h.html#b470e425c6e2ac234bf5d5f6d8d805953828195437a1112429b5c7a3e8780570">MONO</a> : <a class="code" href="includes_8h.html#b470e425c6e2ac234bf5d5f6d8d80595283fc479650da98250635b9c3c0e7e50">WHITE</a>;
<a name="l00051"></a>00051                                         pickupcount = 1;
<a name="l00052"></a>00052                                 }               
<a name="l00053"></a>00053                         } <span class="keywordflow">else</span> {
<a name="l00054"></a>00054                                 <span class="comment">// add pickups</span>
<a name="l00055"></a>00055                                 <span class="keyword">static</span> <span class="keywordtype">int</span> onepickup = 0;
<a name="l00056"></a>00056                                 <a class="code" href="classcPickup.html" title="Encapsulates one pickup.">cPickup</a>* newpickup;
<a name="l00057"></a>00057                                 newpickup = <span class="keyword">new</span> <a class="code" href="classcDownPickup.html">cDownPickup</a>(<a class="code" href="classcPlayMode.html#508e0cbf73c071e90cfcfe84d7b111ca" title="The current pickup (lane) position.">currentposition</a>, <a class="code" href="classcPlayMode.html#cb3bf89d91bdc776c9afd47d2d97646b" title="The current pickup colour.">currentcolour</a>); 
<a name="l00058"></a>00058                                 <span class="comment">//newpickup = new cPickup(currentposition, 0, 1, DOWN); // use this for all red pickups. Debugging purposes.</span>
<a name="l00059"></a>00059                                 <span class="comment">//if (onepickup==0) // use this for only one pickup. Debugging purposes.</span>
<a name="l00060"></a>00060                                 <a class="code" href="classcPlayMode.html#0800c98891eb91f1ea0622ef6eaefb5b" title="Add a pickup to the manager.">addpickup</a>(newpickup); 
<a name="l00061"></a>00061                                 onepickup = 1;
<a name="l00062"></a>00062                                 pickupcount--;
<a name="l00063"></a>00063                         }
<a name="l00064"></a>00064                         
<a name="l00065"></a>00065                         newobjecttimer = SDL_GetTicks();
<a name="l00066"></a>00066                 } 
<a name="l00067"></a>00067                 
<a name="l00068"></a>00068                 SDL_Delay(20);
<a name="l00069"></a>00069                 
<a name="l00070"></a>00070         }
<a name="l00071"></a>00071 }
<a name="l00072"></a>00072 
<a name="l00073"></a><a class="code" href="classcMonoMode.html#f8b14aa69621178a50395c26ff897f93">00073</a> <span class="keywordtype">void</span> <a class="code" href="classcMonoMode.html#f8b14aa69621178a50395c26ff897f93">cMonoMode::changemonocolour</a>() {
<a name="l00074"></a>00074 
<a name="l00075"></a>00075         <span class="keyword">static</span> <span class="keywordtype">long</span> monofactor = 400000;
<a name="l00076"></a>00076 
<a name="l00077"></a>00077         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;3; i++) {
<a name="l00078"></a>00078                 <a class="code" href="includes_8cpp.html#5b6fe6d4823dd8ae4c928ce736e01773">color</a>[<a class="code" href="includes_8h.html#b470e425c6e2ac234bf5d5f6d8d805953828195437a1112429b5c7a3e8780570">MONO</a>][0][i] = 0.5+0.5*sin(  (<span class="keywordtype">float</span>)(SDL_GetTicks() + i*monofactor)  *  <a class="code" href="main_8cpp.html#1dcc4c751312e83f33e6be560fe1c15d">bpm</a>  /
<a name="l00079"></a>00079                                                  <span class="comment">/*------------------------------------------------*/</span>
<a name="l00080"></a>00080                                                                                   (<span class="keywordtype">float</span>)(3*monofactor)                             );
<a name="l00081"></a>00081                 <a class="code" href="includes_8cpp.html#5b6fe6d4823dd8ae4c928ce736e01773">color</a>[<a class="code" href="includes_8h.html#b470e425c6e2ac234bf5d5f6d8d805953828195437a1112429b5c7a3e8780570">MONO</a>][1][i] = <a class="code" href="includes_8cpp.html#5b6fe6d4823dd8ae4c928ce736e01773">color</a>[<a class="code" href="includes_8h.html#b470e425c6e2ac234bf5d5f6d8d805953828195437a1112429b5c7a3e8780570">MONO</a>][0][i]*0.8;
<a name="l00082"></a>00082                 <a class="code" href="includes_8cpp.html#5b6fe6d4823dd8ae4c928ce736e01773">color</a>[<a class="code" href="includes_8h.html#b470e425c6e2ac234bf5d5f6d8d805953828195437a1112429b5c7a3e8780570">MONO</a>][2][i] = <a class="code" href="includes_8cpp.html#5b6fe6d4823dd8ae4c928ce736e01773">color</a>[<a class="code" href="includes_8h.html#b470e425c6e2ac234bf5d5f6d8d805953828195437a1112429b5c7a3e8780570">MONO</a>][1][i]*0.8;
<a name="l00083"></a>00083         }
<a name="l00084"></a>00084 }
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed Aug 6 17:59:51 2008 for Soundboard (audiosurf clone) (temporary name) by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.5 </small></address>
</body>
</html>
